// ==UserScript==
// @name         本地黑名单-新浪微博
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  我的地盘，我做主！
// @author       lavaf
// @match        https://weibo.com/
// @match        https://weibo.com/*
// @match        https://s.weibo.com/weibo?q=*
// @match        https://s.weibo.com/weibo/*
// @match        https://d.weibo.com/*
// @grant        none
// @require         https://cdn.bootcss.com/jquery/3.4.1/jquery.js
// ==/UserScript==

(function () {
    'use strict';
    //https://s.weibo.com/weibo?q=%E8%B7%AF%E8%AF%9E%E5%85%88%E7%94%9F&wvr=6&b=1&Refer=SWeibo_box
    let blackList = ['1095240537', '1739623952', '2422966453', '5872687669', '6071579739', '2832328014', '1246989224',
        '1707826455', '6342595981', '1254509761', '5584699175', '5904645803', '1672009073', '6076330983',
        '6456278033', '6252599351', '1846897444', '5714665931', '2799621212', '5622091826', '5682311618', '5283076169',
        '1651909015', '6316344897', '2128782104', '1927917084', '2752865265', '1896116202', '2103936197', '2112238255',
        '2865491782', '2161285474', '6150149028', '1679497140', '6569600635', '1198432330', '1708837061', '2707058873',
        '5512757319', '1865051515', '6826458805', '5204499107', '3265269384', '1743840000', '1893624707', '2308998613',
        '7378216730', '6042105402', '5832193584', '6936079456', '5186265158', '1497406907', '2067535333', '6345935237',
        '1966575391', '2207117132', '5347867637', '5246052917', '5202581201', '7366694702', '1221586910', '1836763517',
        '3759602395', '5467378834', '5244091770', '1481324167', '2550548823', '2821429691', '1409641392', '5976381459',
        '5375644381', '2864097890', '6117474447', '1525376535', '2707473871', '1642088277', '3834755446', '1107845313',
        '1729395733', '1646422590', '3889809204', '3118326075', '1790047035', '6029852493', '1960631174', '5525661902',
        '1353509550', '2288595114', '5817080538', '3054114113', '1575619643', '7276034416', '1663819761', '1223812162',
        '1852184611', '7388970498', '6725370797', '5874234020', '1708533224', '2423325250', '5097649095', '3489552987',
        '6233189472', '6610865860', '6618748130', '5829653398', '5645463500', '7318146004', '2249877443', '6433748377',
        '1621229732', '2623681923', '6478319459', '5726983480', '5073745996', '5409926707', '7133969587', '7406841612',
        '6854267440', '5534010924', '6854267440', '1081273845', '6214497703', '6051672130', '3173379207', '1774452431',
        '2266078273', '1643194824', '3587736880', '2038088420', '6010980137', '6499603060', '2933933160', '1233848760',
        '2515724614', '6531942617', '5124848832', '3176903793', '1649173367', '6161591278', '5235373093', '2334479323',
        '7237942578', '1439468794', '2530653400', '5936742166', '6483117154', '2274533430', '1646809724', '3173831862',
        '3861637947', '6330190212', '7060567997', '6152993811', '2107947800', '5676315927', '6036499194', '6552619683',
        '2954601765', '5329758882', '7016060628', '6867714779', '1764760204', '5790183505', '6457653381', '6883057572',
        '5591438111', '1633588670', '6338172523', '1764760204', '2405960045', '5379258328', '1996358470', '3489835601',
        '5208094127', '1713520817', '5265134358', '5680268576', '1073273791', '6304986702', '5366062595', '7375863094',
        '6299828876', '6504785918', '6549877954', '1496940541', '2543579625', '2882152550', '5706966061', '3538233267',
        '2699348030', '2140325182', '1765421763', '1632656524', '5643533899', '5812282880', '3829227023', '6053326016',
        '1742591465', '1183186652', '7036322361', '5333937989', '6348028370', '2941996635', '1049862605', '2656861825',
        '5651500951', '1442783975', '1400617904', '6289549776', '2661982093', '6870772320', '5632044829', '5160687416',
        '5604951354', '3754473064', '3625788752', '6081744745', '6297828734', '6610528977', '6450289839', '6450289839',
        '5734852264', '3662721101', '2706508644', '5928267794', '3910455156', '5803122677', '6029762667', '5660330600',
        '2088874107', '7020996998', '1652768147', '1308165280', '3212476685', '6343775938', '3790673270', '1677403621',
        '7329923401', '6697274401', '6489233789', '3275085401', '2607875395', '7454125721', '5645240699', '6101787487',
        '3525925645', '3192574940', '1671675572', '6976255023', '5822161069', '3919792526', '5967321193', '1773206563',
        '7395343315', '5703807437', '5617991845', '5569450037', '2534494835', '3185057053', '5685445107', '5985305304',
        '2813432731', '1712402923', '2427835305', '7241123911', '5682029815', '1747537062', '6681791335', '1843475940',
        '2019743535', '6368625304', '7028970089', '1615420827', '1644700745', '2011848973', '2087656595', '1738580712',
        '2905578983', '6470901910', '6649421500', '6550596895', '7275538696', '6190644910', '2925219620', '2203318630',
        '3077157477', '6572778130', '2954325032', '2141611490', '6735820241', '6250455238', '5950044539', '6732437773',
        '6320525484', '2677204684', '1421011563', '5493483288', '6420427870', '2824136327', '5100980780', '3201102714',
        '5614275287', '5982093060', '1467883652', '3310872281', '7048875874', '5761575336', '2275757881', '3237139890',
        '1881940564', '1799510455', '6564673602', '2456266501', '3026570553', '6512113818', '1959830294', '3170235842',
        '5644576705', '7189933293', '1780944561', '5690428069', '6434996036', '7256718176', '1682023293', '96155866',
        '2705087863', '1716300575', '3905327796', '2631952531', '2963989755', '5338099477', '1833665195', '6355083739',
        '1870736965', '5647119937', '1888015977', '1823087383', '2883340160', '2814697172', '5505719076', '2102720142',
        '1937627901', '1727659112', '5458469167', '1952195195', '5649381807', '1929060243', '2641910215', '5528678952',
        '2836610594', '1936359800', '2637339372', '3502466401', '5255998308', '5640261250', '1784491561', '2612122801',
        '2143372152', '2513314580', '2160176954', '1597428653', '2770907897', '5486655240', '6436177344', '1649111590',
        '1729382834', '5743386999', '1969030412', '1779990993', '5074648251', '1682023293', '1201573204', '1611454944',
        '6027174524', '3209225565', '3878220945', '1770154187', '3666192867', '6540407299', '2101473681', '2670024403',
        '1905404365', '1291446497', '6593704215', '7455823050', '2516565221', '6679292544', '1701314494', '7442757814',
        '2006985875', '2483051317', '6338318517', '2135568691', '7059016503', '5261041725', '5722402926', '5904069236',
    '2514130160','7417216078','6338318517','6588197346','2841165167','3655324487','6880614654','5974163287','5708619256',
    '3234450330','2907464320','5816578271','2989802702','7075000760','2143999320','6861495019','5599592353','2495975764',
    '5729855809','5034021958','2259781977','5687273962','6048648589','7160345268','6589783086','5044228183','3016573122',
    '2423857420','3094337731','5676201756','6086201155','1795309214','7419659102','1267782210','6620484545','5154960595',
    '3060977401','5785483661','7365467277','7365467277','5178649094','7236397568','1787299130','1764865887','1900806997',
    '6324911623','7265763736','6995290037','6995290037','2376204832','1348998797','5646848444','2104333291','5644226745',
    '6198340723','7406939219','2772025061','2940278321','1093568611','3837729732','1759227503','6069874793','6401524986',
    '6865162311','2692502785','5373916047','5520024940','5844033579','6048593429','7368058422','7387363260','2106176065',
    '6894109660','1794722045','6422588775','2095548305','2235242087','5312276735','3213695511','5737061872','2435747193',
    '5304304683','5596050409','2584432724','6317327189','5803331009','7031799273','5319597645','3584380290','2771779794',
    '7210097894','7331888500','5770591972','5745483184','7202035335','3661559181','5110250291','5901151993','6157374971',
    '5110250291','5767716108','5767716108','2696085017','7269458924','5974727783','7412535826','7412535826','1782654481',
    '5170689610','7380214748','7214985481','6970244017','2770275563','6008372455','6970244017','5782470066','5508273652',
    '6974736330','6051691984','6117700684','1817993140','2309045847','6528332741','5075484654','2360677960','2025238792',
    '2385490831','1240210935','5097577370','6165797930','6026341201','6894792105','5602708432','5585680038','1582327110',
    '6065861185','5387425742','2642215513','1853455464','2538443313','5932169226','5769704289','2648025062','7317976212',
    '3157144162','6454410291','7414303945','1565498030','2124505133','6445725567','5732775284','1395064344','1892003537',
    '1793134894','6591594279','1903217321','7029691573','7120271978','7152619916','1709122990','1784703172','7403260005',
    '6199966977','5661575667','7311976061','7293468586','7438102867','6068981091','1402138343','5873314059','2713866045',
    '6524186068','1848176875','6085759497','1765373140','6197836158','1811158751','3196427067','3645292723','1733021227',
    '1931850117','5033712080','6438672871','5479222473','3136904425','2125139354','3247709450','6260498198','2138005020',
    '5356016401','3435974364','5160416353','2021214587','5499888459','3742343551','2042334387','3204929810','5309189802',
    '6418826195','5671437453','6505428386','3127678941','5314300130','2881411764','5817668677','1628445871','5609166080',
    '2034965711','5850890302','5715728524','5259378277','5694413522','2586281922','6174606644','7347413193','6013657906',
    '6727354361','2383657267','2247639405','7307025478','7046967184','1918746645','6618757242','7243484728','5157634170',
    '6457418465','3287998357','5969763286','6212569431','6466176401','7332832073','5369362308','3871636954','3871636954',
    '3676574145','1832833585','7393887334','1884722495','5802459722','2367986534','6576097248','1699740504','1642037123',
    '3166500604','5756183637','6236376326','1078841602','2409009617','5643531670','5568371401','2796524584','5165571693',
    '5573974880','2629705321','1649965867','1710003524','2814930034','1796888592','2464125525','3558086924','5870326812',
	'6605055676','2064759093','1973843233','3936424999','5515030438','2874407404','2150108740','1689554123','3494786670',
'1588066533','6313219358','5048733065','1973977312','3837362505','6132135491','3977214739','3750663930','5100126765','1783181043',
'2054022231','1326592902','2694025893','5682379749','6481271992','2775278300','2211706157','2462112154','6554646182',
'5462377555','1927205713','5202591341','6884770037','5261903019','5641526696','5641526696','6834711692','2345319311',
'2759863717','7192912904','2898855132','1908359935','6243702393','5865789716','5281281648','1660229751','6460202772',
'5070490462','1268857245','1015893543','1702676987','1655567254','6023598583','5485378509','6030519301','1686385614',
'6470689960','6265523923','5645178296','3814374509','5245167522','1794512494','6376702091','3895392853','3535188241',
'2729295357','5519859121','6963828593','2184469317','2157787635','1840317402','6569464958','6230444231','6182393470',
'1539706701','5686693708','6779476743','6144452934','2019513635','1672632753','5130841897','2819891094','5848292198',
'2726658191','2311064250','3987576274','6597834869','3830803079','2004959695','2432393272','2002629995','5190623232',
'5054189478','6482282493','5345446734','5021700524','3276182495','7031602937','5061586326','1343314141','5528117441',
'3236006804','1017158903','5969491143','6100532141','2144199431','3146360214','1899121524','3164771695','5744063345',
'6309486033','3034931441','5479195565','2141205130','5898759839','2191832765','5531425389','5106320070','7339160131',
'5430403256','7386439455','1785547404','1772505154','5816455027','2559461871','7452239089','3024240421'];
    let set = new Set(blackList);
    setInterval(function () {
        //console.log('start')

        let nameList = $("div.WB_feed_type");
        nameList.each(function (i, e) {
            if ($(e).attr('data-lavaf') !== '1') {
                let fb = $(e).find("a.W_fb");
                if (fb.length == 0) {
                    console.log(e);
                    return;
                }
                let id = fb.attr("usercard");
                let index = id.indexOf("&");
                let s = id.substring(3, index);
                if (set.has(s)) {
                    $(e).text(id + " 此用户已经被屏蔽")
                    $(e).attr('data-lavaf', '1');
                }
            }

        });
        let List = $("div.list_li");
        List.each(function (i, e) {
            if ($(e).attr('data-lavaf') !== '1') {
                let id = $(e).find('div.WB_text').children("a").attr("usercard")
                if (id.indexOf("2826909263") >= 0) {
                    console.log(id, set.has('2826909263'));
                }
                for (const blackListKey in blackList) {
                    if (blackList.hasOwnProperty(blackListKey)) {
                        //console.log(id);
                        if ("id=" + blackList[blackListKey] === id) {
                            $(e).text(id + " 此用户已经被屏蔽");
                            $(e).attr('data-lavaf', '1');
                            break;
                        }
                    }
                }
            }

        });
        let List1 = $("div.card-wrap[action-type='feed_list_item']");
        List1.each(function (i, e) {
            if ($(e).attr('data-lavaf') !== '1') {
                let fb = $(e).find("a.name");
                if (fb.length == 0) {
                    //console.log(e);
                    return;
                }
                let id = fb.attr("href");
                for (const blackListKey in blackList) {
                    if (blackList.hasOwnProperty(blackListKey)) {
                        //console.log(id);
                        //console.log("s:"+s+" "+id);
                        if (id.indexOf("//weibo.com/" + blackList[blackListKey] + "?") === 0) {
                            $(e).text(id + " 此用户已经被屏蔽")
                            $(e).attr('data-lavaf', '1');
                            break;
                        }
                    }
                }

            }

        });
        //
        let List2 = $("div.card-review[node-type='feed_merge_list_reply_item']");
        List2.each(function (i, e) {
            if ($(e).attr('data-lavaf') !== '1') {
                let fb = $(e).find("a.name");
                if (fb.length == 0) {
                    //console.log(e);
                    return;
                }
                let id = fb.attr("href");
                for (const blackListKey in blackList) {
                    if (blackList.hasOwnProperty(blackListKey)) {
                        //console.log(id);
                        //https://weibo.com/u/5790183505?refer_flag=1001030103_
                        if (id.indexOf("////weibo.com/u/" + blackList[blackListKey] + "?") === 0) {
                            $(e).text(id + " 此用户已经被屏蔽")
                            $(e).attr('data-lavaf', '1');
                            break;
                        }
                    }
                }

            }

        });
        let List3 = $("div.card-review");
        List3.each(function (i, e) {
            if ($(e).attr('data-lavaf') !== '1') {
                let fb = $(e).find("a.name");
                if (fb.length == 0) {
                    //console.log(e);
                    return;
                }
                let id = fb.attr("href");
                for (const blackListKey in blackList) {
                    if (blackList.hasOwnProperty(blackListKey)) {
                        //console.log(id);
                        //https://weibo.com/u/5790183505?refer_flag=1001030103_
                        if (id.indexOf("//weibo.com/u/" + blackList[blackListKey] + "?") === 0) {
                            $(e).text(id + " 此用户已经被屏蔽")
                            $(e).attr('data-lavaf', '1');
                            break;
                        }
                    }
                }

            }

        });
    }, 500)

})();